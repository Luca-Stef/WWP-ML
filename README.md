# ml-activity-classification
Main chunk of documentation is written in activity_classification.py script. The script reads data from the data folder, trains and evaulates model and plots confusion matrices and loss functions in the figures folder. It then saves the model in the models folder. Naming convention for models is the model name followed by the number of weights followed by the accuracy. Also check intro
[video](https://drive.google.com/file/d/12QHOFvm3AzrmPDS4lOkBtAYPa2hFUUN8/view?usp=sharing)

[keras2c](https://github.com/f0uriest/keras2c) was used to convert the model to a c function. If you make a new model, just save it or convert to .h5. Then clone keras2c and install the requirements.txt file, it will be able to turn that .h5 file into a c file and a header file. The command line lets you choose between time efficiency and space efficiency. Then just copy the .h and .c files, and the csv files if using the space efficient option. You also need to copy the include folder from the keras2c repo and may need to run `make` inside that folder to generate a libkeras2c.a file (keras2c has some more documentation). You need this lib file to run the test suite but it's not clear if this must be addded to the .emProject file as well to compile in firmware.

The frequency and the sensor reading window needs to match up exactly with the windows used in training. If you use a different frequency and window length such that the input array has the exact same shape as used in training, the function will still do the inference but the accuracy will be lower. Average time between readings in the training data is 19.5 ms so roughly 50Hz frequency but this may need to be triple checked...
